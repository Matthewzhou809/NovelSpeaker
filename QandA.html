<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Q&amp;A</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <section id="main_content">
<h3 id="Q&A">Q&amp;A</h3>
<div>
ことせかい に寄せられたご意見ご要望について、何らかの理由で実装されなかったご提案について記述しておきます。
</div>
<div>

<hr/>
目次
<ul>
	<li><a href="#TimeInformationForControlCenter">コントロールセンターに表示される情報に時間も追加できないか</a></li>
	<li><a href="#Replacement dictionary Cloud">読み替え辞書をユーザ間で共有したい</a></li>
	<li><a href="#DownloadFailed">何らかの問題で期待しないデータがダウンロードされてしまった章について</a></li>
	<li><a href="#VerticalDisplay">縦書き表示について</a></li>
	<li><a href="#Slider">スライダーについて</a></li>
	<li><a href="#DateTimeFieldForSendInquiriesPage">アプリ内の不都合報告フォームでの日時指定フィールドについて</a></li>
	<li><a href="#Ruby">ルビ表示の改善について</a></li>
</ul>
</div>

<hr/>
<h4 id="TimeInformationForControlCenter">コントロールセンターに表示される情報に時間も追加できないか</h4>
<div>
読み上げ時にコントロールセンター(画面の下から引き出すと出て来たり、ロック画面に出てくるアレです)に表示される情報で時間が出るといいなぁというご意見を頂いたのですけれど、ざっと実装の実験をしてみた限りでは色々と面倒くさい問題を解かないと駄目そうなのでお蔵入りにすることにしました。簡単に説明致しますと、「読み上げる時間が推測しにくいが登録するのは時間」という事と、「再生位置の更新をアプリ側から伝えられない(勝手に更新される)ので『今はだいたいこの辺り』という情報を反映できない」ためです。まぁ、だいたいこの文章量なら3分位なんじゃない？って当てずっぽうで3分と宣言しておいて、2分半で読み終わっちゃったり、3分過ぎても読み終わってなかったりしてもいいのならそれはそれでいいのですが、多分、コントロールセンターで表示されている情報と一致しないとかいう不都合報告が飛んでくるんじゃないかと思いますのでそういうツッコミどころを増やすようなものになるのであれば実装はできないなぁという判断になりました。
</div>

<hr/>
<h4 id="Replacement dictionary Cloud">読み替え辞書をユーザ間で共有したい</h4>
<div>
読み替え辞書をクラウド的なものでユーザ間で共有して編集できないかというご提案について。
</div>
<div>
これは実現したらとても良いものになるとは思うのですが、そのクラウド的な物を維持するのにはお金がかかるので、ことせかい の開発者側としては対応できない案件となります。ことせかい が何らかの形で定常的にお金を生むような形にしていればよかったのかもしれませんがそうはなっていませんし、今から何らかのお金を生む要素を入れるのは多くの人が望まない事ですよね。なので、やる気はありません。ただ、数年間分のサーバ費用にオマケもつけるからやってくれという人が現れたり、自分がサーバ側を管理運営するのでアプリ側はなんとかしてくれという人が現れたり、この無料のサービスをこうやって使うと実現できるんじゃね？というウルトラCを考えついたりしたらあるいは、という気もしなくもありません。(もちろん、その費用が尽きたりサーバ運営をしてくれている人が諦めたりその無料サービスから想定外の使い方しちゃ駄目と怒られたらそこでそのクラウド読み替え辞書共有サービスは終了になりますので、不安定なサービスであるといえます)
</div>

<hr/>
<h4 id="DownloadFailed">何らかの問題で期待しないデータがダウンロードされてしまった章について</h4>
<div>
これは、例えば小説ではなく、「アクセス数が多いのでエラー」といったものがダウンロードされてしまった、というような場合の事です。
現状では、既にダウンロードして登録されてしまった部分(章)を再ダウンロードする方法はありません。
</div>
<div>
内部的には HTTP のステータスコードでエラーを返してくれている(200 OK ではない場合、例えば 429 Too many requests を返している)場合であれば、ダウンロードが失敗したとみなして保存せずにダウンロードを終了しています(していない例がありましたら不都合になりますのでお問い合わせフォーム等から教えてください)。逆に、HTTPのステータスコードによるエラー以外で「アクセス数が多いのでエラー」という文字列が取得できてしまう場合(200 OK で取得したデータの場合)には、ダウンロードが失敗したかどうかを判定するのは難しいため、そのままの文字列が保存されてしまいます。これをユーザ様の側で「この章だけ再ダウンロードせよ」という指示を出せるようにしたらよいか、とも思ったのですが、現在の内部データベース仕様ですと「その章」がどんなURLであったのかの情報が不足しており、再ダウンロードすることができないために実現できませんでした(現状では最初にダウンロードしようとした章のURLと、最後にダウンロードしようとした章のURLしか保存されていませんので、10章分読み込んでいた場合には2章から9章までは再ダウンロードすることができない、という状態です)。
</div>
<div>
なので、「アクセス数が多いのでエラー」といったようなエラーメッセージそのものが保存されてしまっている場合は一旦小説を本棚から削除して、通信環境の良い所で再度ダウンロードしていただく必要があります。
</div>
<div>
この問題については将来的には対応しようとは思っているのですが、現在の内部データベース形式では上記の理由で無理となります。また、将来的に対応できたとしても、現在既にダウンロード済みのものについて(上記の例だと2章から9章について)はURLを推測できない関係上、対応が不可能な問題となります。予めご了承ください。
</div>

<hr/>
<h4 id="VerticalDisplay">縦書き表示について</h4>
<div>
まず、ことせかい は「読み上げ」アプリですので「目で読む」ための機能については真面目にサポートするつもりはありません。
</div>
<div>
また、縦書き表示についてのお問い合わせは何度か受けておりますので少し調査してみたことがあるのですが、残念なことに簡単には縦書き表示はできそうにありませんでした。
</div>
<div>
グダグタと調査したものを書き下しますと、NSAttributedString に NSVerticalGlyphFormAttributeName 辺りを設定すると縦書き表示ができそうなのですが、1行分しか縦書き表示してくれないようであったり、TTTAttributedLabel というライブラリを公開してくれている人が居てそれを使うと良さそうだと思ったら、Label であって TextView ではないのでスクロールできなかったり、UIWebView に CSS で writing-mode: vertical-rl; 辺りを含ませた物を表示させれば綺麗な縦書き表示ができるかと思ったけれど、現在の読み上げ位置をハイライトする方法が一筋縄ではいかなくて断念したり、といった感じです。最後の UIWebView 辺りの仕組みがうまく動くのであれば表示している WebPage をそのまま読み上げさせる事や、挿絵を表示しながらの閲覧もできるようになりそうでいいかなぁとも思ったんですけれども、読み上げアプリとしては読み上げ位置が見えないのはなぁということでお蔵入りになりました。なお、これらは 2,3年前 に調査したものになりますので、今ではもっと良い方法があるかもしれません(その辺りの知識のある方がおられましたら教えていただければ嬉しいです)。
</div>

<hr/>
<h4 id="Slider">スライダーについて</h4>
<div>
ことせかい の中の色んな所にあるスライダー(左右にスライドして値を入力する奴)なんですけれど、これ、微妙な値を指示したい場合にはちょっと面倒ですよね。そんな時は、スライダーのつまむ所(丸い奴)をタップしたまま(つまむ所が見える状態になるまで)指を下にずらして、そこで指を左右に傾けるような形で位置を調整すると微妙な値もなんとなく入力できます。まぁ正確に0.1づつ動かしたい、みたいなのには使えないのですけれど、覚えておくとちょっと便利な感じです。あ、これは左右への0.1づつとかのボタンを配置するのが面倒だから言っているのではなくてですね、ボタンを配置てしまうとiPhone SEとかの幅の狭い端末だとレイアウトが崩れちゃってちゃんと操作できなくなっちゃうのでボタンを配置できない所があったりするのです。
</div>

<hr/>
<h4 id="DateTimeFieldForSendInquiriesPage">アプリ内の不都合報告フォームでの日時指定フィールドについて</h4>
<div>
ことせかい アプリ内の不都合報告フォームでの日時指定フィールドが、標準で1日後になっていて送信時に「問題のある入力項目」になってしまう、というお問い合わせがありました。
</div>
<div>
これは、少しでも多くの人に正しい問題発生日時を入力して欲しいために、必ず、指定しないとエラーにする、という事をしているための施策になります。横着なさらずにちゃんと正しい日時を入力してくださいますようお願い致します。
</div>

<hr/>
<h4 id="Ruby">ルビ表示の改善について</h4>
<div>
まず、ことせかい は「読み上げ」アプリですので「目で読む」ための機能については真面目にサポートするつもりはありません。
</div>
<div>
なのですが、簡単に実現できるのに実装しないのだとすると悪い気もしますので、調査してみました。しかし、残念なことにルビの表示を簡単に実現するのは難しいという結論に達しましたため、この機能については見送りました。
</div>
<div>
ことせかい で小説を表示している画面では、UITextView というコンポーネントを利用しています。このコンポーネントは NSAttributedString という、属性つきの文字を表示する機能があります。この NSAttributedString には CTRubyAnnotation というルビをふるためのそのものの属性があります。なのですが、どうも UITextView はこの CTRubyAnnotation には対応していないようです(設定してみても何も起こりませんでした)。UILabel という別のコンポーネントでは同様にCTRubyAnnotation属性を設定した文字列にルビが振られましたので、多分使い方が間違えているとは思えませんでした。では UILabel を使えばいいではないかと思った人は鋭いかもしれませんが、UILabel ですとスクロールができませんし、範囲選択という概念もありませんので小説の本文を表示するためには使えません。
ではどうするのが良いのかというと恐らくは WKWebView といったような HTML のレンダラを使っての表示にしてしまうのが良いと考えられますが、<a href="#VerticalDisplay">縦書き表示について</a>の所でも書きましたように、それはそれで解かねばならない問題が解けませんでしたので採用できないという判断になりました。
</div>
<div>
以上の理由から、ルビの表示の改善については見送らせて頂いています。
</div>
</section>
        <footer>
          ことせかい is maintained by <a href="https://github.com/limura">limura</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>
      </div>
    </div>
  </body>
</html>
